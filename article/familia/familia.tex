\addcontentsline{etoc}{chapter}{\textit{Surname1 A1.\,B1., Surname2 A2.\,B2.} Title}

\begin{abstract}
В современных информационных системах большое значение имеет криптография с открытым ключом. Подобные системы реализованы, к примеру на эллиптических кривых. Они используют проблему дискретного логарфима в применении к точкам на эллиптических кривых над конечными полями. Подобные системы нашли применение, к примеру, в ГОСТ Р 34.10-2012. В практических применениях важна не только защищенность системы, но и ее производительность. Различные представления точек на кривых позволяют оптимизировать процесс вычислений и ускорить производительность. В данной статье рассматриваются различные представления точек с точки зрения количества требуемых операций и используемой памяти на примере ECDSA - алгоритма для создания цифровой подписи.
\kwr Криптография с открытым ключом, эллиптические кривые, ЭЦП 

\blfootnote{\hspace{-7pt}\textcopyright \, Захаров П.\,С., Пискун М.\,Г., 2018\\ \indent\textcopyright \, Федеральное государственное автономное образовательное учреждение высшего образования\\
\indent\hspace{15pt}<<Московский физико-технический институт
(государственный университет)>>, 2018}

\end{abstract}

\bigskip

%Примерная структура статьи.

\section{Введение}

В настоящее время распространены ассиметричные криптографические алгоритмы с открытым ключом. В таких алгоритмах существует два ключа - открытый, передавемый по незащищенному каналу, и закрытый, держащийся в тайне и тяжело вычисляющийся из открытого. Такие системы используются для проверки цифровых подписей или обмена ключами от симметричных систем. К ним относятся широко известные алгоритмы Диффи-Хеллмана, Эль-Гамаля, шифр RSA и другие\cite{s3}. 

Реалии современного мира предъявляют высокие требования как к защищенности криптосистем, так и к их производительности. Первое требование, помимо прочего, обуславливает выбор больших параметров системы (к примеру, порядок используемого конечного поля), в особенности для ассиметричных криптосистем. В сочетании с большим количеством вычислений, требующихся для произведения одной итерации шифрования или создания одной подписи, это явно противоречит второму требованию. В связи с этим используются различные методики более быстрых вычислений. 

В криптографии на эллиптических кривых основой вычислений являются операции над точками на кривой - сложение и умножение на число. Каждая из этих операций подразумевает определенное количество сложений, умножений и инверсий в конечном поле. Более сложные представления точек позволяют сократить число этих операций за счет хранения большего количества информации\cite{s1}. В данной работе сравниваются разные представления с точки зрения производительности и используемой памяти. В разделе 1 вводятся эллиптические кривые и описывается тестовый алгоритм - ECDSA (Elliptic Curve Digital Signature Algorithm), в разделе 2 рассматриваются различные представления точек, в разделе 3 описывается вычислительный эксперимент. В разделе 4 обсуждаются результаты.

\section{Эллиптические кривые и ECDSA}
\begin{Def}
Эллиптической кривой на плоскости называется кривая в $\mathbb{R}^2$, описываемая выражением \begin{equation}
y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6
\end{equation}
\end{Def}

Практическое приложение имеют эллиптические кривые над конечными полями - в этом случае коэффициенты и координаты точек принадлежат соответсвующему полю. В случае, если характеристика поля не равна 2 или 3, кривая может быть приведена к виду\cite{s1}:
\begin{equation}
\label{curve}
y^2=x^3+ax+b, a,b,x,y\in K
\end{equation}

Если к множеству точек кривой добавить $\infty$, то на получившемся множестве $E$ можно ввести операцию сложения (и, соответсвенно, умножения на целое)\cite{s2}. Нетрудно показать, что $E$ с соотвествующим образом определенной операцией является группой. В данной группе имеет место проблема дискретного логарифма для точек на эллиптических кривых\cite{s2}:
\begin{Def}
Пусть $E$ - эллиптическая кривая над полем $K$, и $G$ - точка на $E$. Задачей дискретного логарифмирования на $E$ с основанием B называется задача нахождения для данной точки $P\in E\, a\in K$(если существует) такого, что $P=aG$
\end{Def}
Если кривая не является суперсингулярной, не существует субъэкспоненциального алгоритма для решения этой проблемы. На основе её и создан алгоритм цифровой подписи ECDSA.

Алгоритм ECDSA подразумевает, что Алиса и Боб договорились относительно используемых кривой и поля. При этом в группе точек на этой кривой должна быть циклическая подгруппа достаточно большого простого порядка $q$. Пусть $P$ - порождающая точка в этой подгруппе, т.е. $qP=O$. Алиса выбирает случайное число $d\in \left[ 1, q-1 \right]$ - это ее закрытый ключ. Точка $Q=dP$ - открытый ключ. ($P$ также известна всем участникам. Проблема дискретного логарифма гарантирует сохранность закрытого ключа)

Пусть $m=h\left( M\right)$ - хэш сообщения (достаточно короткий), $k$ - случайное число их $\left[ 1, q-1 \right]$. Дальнейшие вычисления:
\begin{eqnarray}
C=kP & = & \left( x_c, y_c\right) \nonumber \\
r & = & x_c\; mod\; q \nonumber \\
s & = & k^{-1}\left( m+rd\right)\; mod\; q
\end{eqnarray}
Пара $\left( r, s\right)$ - подпись.

Для проверки подписи Бобу требуется проверить, что $0 \leq r,s\leq q-1$, а также провести вычисления:
\begin{eqnarray}
\label{v}
v_1 & = & s^{-1}h\; mod\; q \nonumber \\
v_2 & = & s^{-1}r\; mod\; q \nonumber \\
v_1P+v_2Q & = & \left(x_b, y_b\right) \nonumber \\
\hat{r} & = & x_b\; mod\; q
\end{eqnarray} 
Полученное в (\ref{v}) $\hat{r}$ должно совпасть с $r$

\section{Представления точек}

Сложение, а тем более умножение точки на число является затратной операцией: в стандартных координатах в кривых над полями с характеристикой, отличной от 2 и 3, сложение точек выглядит следующим образом. Пусть $P=(x_P, y_P), Q=(x_Q, y_Q) \in E, P\neq \pm Q$. Тогда для $R=P+Q$
\begin{equation}
\label{addition}
x_R = \left(\frac{y_Q-y_P}{x_Q-x_P}\right)^2-x_P-x_Q,\quad y_R = \left(\frac{y_Q-y_P}{x_Q-x_P}\right)\left(x_P-x_R\right)-y_P
\end{equation}
Видно, что для сложения точек требуется инверсия и умножение в поле. Первая является особенно дорогостоящей операцией, и от нее хотелось бы избавиться. Это позволяют сделать другие координатные системы\cite{s2}, которые позволяют добиться лучшей производительности за счет дополнительной информации. Одним из таких представлений являются проективные координаты.

\begin{Def} 
Пусть $c,d$ - положительные целые. Рассмотрим следующее отношение эквивалентности на $K^3\setminus \left\lbrace \left(0,0,0\right) \right\rbrace$:
\begin{equation}
\left(X_1, Y_1, Z_1\right) \sim \left(X_2, Y_2, Z_2\right) \Leftrightarrow \exists \lambda \in K: X_1=\lambda^cX_2, Y_1 = \lambda^dY_2, Z_1=\lambda Z_2
\end{equation}
Оно разбивает $K^3\setminus \left\lbrace \left(0,0,0\right) \right\rbrace$ на классы эквивалентности. Эти классы эквивалентности будем называть проективными точками.
\end{Def} 
Отметим, что при этом либо у всех представителей класса $Z=0$, либо есть представитель с $Z=1$. Сопоставим точке $P = \left(X, Y\right)$ на кривой класс с представителем $\left(X, Y, 1\right)$. Если подставить в \ref{curve} $x=\frac{X}{Z^c}, y=\frac{y}{Z^d}$ и избавиться от знаменателя, то можно получить уравнение кривой в проективных кординатах. Проективные точки с $Z=0$, удовлетворяющие уравнению, будут считаться точками на бесконечности. Различный выбор c и d порождает разные виды проективных координат:
\subsection{Стандартные проективные координаты: $c=1,\,d=1$}

В данном случае проективной точке $\left(X:Y:Z\right), Z\neq 0$, сопоставляется афинная точка $\left(\frac{X}{Z}, \frac{Y}{Z}\right)$. При подстановке (\ref{curve}) переходит в 
\begin{equation}
\label{curve_1}
Y^2Z=X^3+aX^2Z+bZ^3
\end{equation}
Этому уравнению удовлетворяет точка $\left(0:1:0\right)$ - ей будет соответствовать афинная точка $\infty$. Заменим в (\ref{addition}) афинные координаты на проективные, при этом в выражении для ${Y'}_R$ учтя, что $x_P-x_R=2*x_P+x_Q-\left(\frac{y_Q-y_P}{x_Q-x_P}\right)^2$:
\begin{eqnarray}
\text{Пусть  } M & = & Y_QZ_P-Y_PZ_Q,\quad N=X_QZ_P-X_PZ_Q.\quad\text{Тогда} \nonumber \\
X_R' & = & \left(\frac{M}{N}\right)^2-\frac{X_PZ_Q+X_QZ_P}{Z_PZ_Q} = \frac{M^2Z_PZ_Q-N^2\left(X_PZ_Q+X_QZ_P\right)}{N^2Z_PZ_Q}\nonumber \\
Y_R' & = & \left(\frac{M}{N}\right)\left(2*\frac{X_P}{Z_P}+\frac{X_Q}{Z_Q}-\left(\frac{M}{N}\right)^2\right) - \frac{Y_P}{Z_P} =\nonumber \\
& = & \frac{M\left(N^2\left(2*X_PZ_Q+X_QZ_P\right)-M^2Z_PZ_Q\right)}{N^3Z_PZ_Q} - \frac{Y_P}{Z_P}\nonumber
\end{eqnarray}
Пользуясь соотношением эквивалентности, избавимся от знаменателя, задав $Z_R = N^3Z_PZ_Q$:
\begin{eqnarray}
X_R & = & NM^2Z_PZ_Q-N^3\left(X_PZ_Q+X_QZ_P\right)\nonumber \\
Y_R & = & M\left(N^2\left(2*X_PZ_Q+X_QZ_P\right)-M^2Z_PZ_Q\right) - Y_PZ_QN^3 \\
Z_R & = & N^3Z_PZ_Q \nonumber
\end{eqnarray}

Аналогичным образом выводятся формулы для удвоения точки:
\begin{eqnarray}
X_R & = & M^2N-4N^2X_PY_P \nonumber \\
Y_R & = & 6X_PY_PMN-M^3-2N^2Y_P^2 \\
Z_R & = & N^3, \nonumber
\end{eqnarray}
где $M=3X^2_P+aZ_P^2,N=2Y_PZ_P$. Как видно, в случае выбора этих кординат нет нужды производить инверсию в поле - операцию гораздо более трудоемкую, нежели сложение или умножение.
\subsection{Проективные координаты Якоби: $c=2, d=3$}

Проективной точке $\left(X:Y:Z\right), Z\neq 0$, сопоставляется афинная точка $\left(\frac{X}{Z^2}, \frac{Y}{Z^3}\right)$. Уравнение кривой выглядит следующим образом:
\begin{equation}
\label{curve_2}
Y^2=X^3+aXZ^4+bZ^6
\end{equation}
Используя рассуждения, подобные использовавшимся в предыдущем пункте, получаем формулы для сложения
\begin{eqnarray}
M & = & Y_QZ_P^3-Y_PZ_Q^3,\quad N = X_QZ_P^2-X_PZ_Q^2 \nonumber \\
X_R & = & M^2 - N^2\left(X_PZ_Q^2+X_QZ_P^2\right) \\
Y_R & = & MN^2\left(2X_PZ_Q^2+X_QZ_P^2\right)-M^3-Y_PZ_Q^3N^3 \nonumber \\
Z_R & = & Z_PZ_QN \nonumber
\end{eqnarray}
и удвоения:
\begin{eqnarray}
X_R & = & \left(3X_P^2+aZ_P^4\right)^2-8X_PY_P^2 \nonumber \\
Y_R & = & \left(3X_P^2+aZ_P^4\right)\left(4X_PY_P^2-X_R\right)-8Y_P^4 \\
Z_R & = & 2Y_PZ_P \nonumber
\end{eqnarray}
\section{Вычислительный эксперимент}

Для оценки ускорения произведения расчетов был поставлен вычислительный эксперимент. На языке программирования C++ был реализован ECDSA. При этом арифметика точек на кривой описывалась соответствующим классом; в зависимости от выбранного класса получась реализация с тем или иным представлением\footnote{Код см. \url{https://github.com/PaulZakharov/elcurves_2018}}. Использована модульная арифметика из библиотеки CryptoPP.

На 4 эллиптических кривых были измерены средние времена сложения двух точек, удвоения точек (усреднение по 100000 операциям), а также среднее время создания и проверки подписи ECDSA (усреднение по 1000 циклам подпись-проверка подряд).

В эксперименте использовались следующие кривые:
\begin{table}[h]
\begin{small}
\label{used_curves}
\caption{Кривые, используемые в эксперименте}
\begin{tabular}{|c|c|c|}
\hline
Эллипт. кривая & Характеристика поля p & Длина p в битах \\
\hline
secp224r1 & $2^{224}-2^{96}+1$ & 224 \\
\hline
ГОСТ Р 34.10-2012 & $2^{255}+2^{10}+2^5+2^4+1$ & 256 \\
\hline
secp256r1 & $2^{224}\left(2^{32}-1\right)+2^{192}+2^{96}-1$ & 256 \\
\hline
secp384r1 & $2^{384}-2^{128}-2^{96}+2^{32}-1$ & 384 \\
\hline
\end{tabular}
\end{small}
\end{table}

Эксперимент производился на ПК с ЦП Intel\textsuperscript{\copyright} Core\textsuperscript{\copyright} i5-4210U, 5.7 ГиБ RAM, ОС Ubuntu 18.04.

\section{Результаты эксперимента}

Результаты сгруппированы по операциям в таблицах 1.2-1.4. Можно отметить, что блабла
\begin{table}[h!]
\begin{small}
\caption{Время выполнения 100000 сложений точек, сек.}
\label{experiment_sum}
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{3}{*}{Кривая} & \multicolumn{3}{c|}{Представление точек} \\
\cline{2-4}
& Стандартное & Стандартные проективные & Координаты Якоби \\
& представление & координаты & \\
\hline
secp224r1 & 2.35622 & 1.15444 & 1.36507 \\
\hline
ГОСТ Р 34.10-2012 & 2.6434 & 1.38615 & 1.49098 \\
\hline
secp256r1 & 2.59941 & 1.44127 & 1.68085 \\
\hline
secp384r1 & 4.52602 & 1.59166 & 1.76918 \\
\hline
\end{tabular}
\end{small} 
\end{table}

\begin{table}[h!]
\begin{small}
\caption{Время выполнения 100000 удвоений точек, сек.}
\label{experiment_double}
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{3}{*}{Кривая} & \multicolumn{3}{c|}{Представление точек} \\
\cline{2-4}
& Стандартное & Стандартные проективные & Координаты Якоби \\
& представление & координаты & \\
\hline
secp224r1 & 2.3641 & 1.04436 & 1.41838 \\
\hline
ГОСТ Р 34.10-2012 & 2.66652 & 1.25433 & 1.55236 \\
\hline
secp256r1 & 2.74057 & 1.30299 & 1.96315 \\
\hline
secp384r1 & 4.55902 & 1.36684 & 1.84759 \\
\hline
\end{tabular}
\end{small} 
\end{table}

\begin{table}[h!]
\begin{small}
\caption{Время выполнения 1000 циклов "создание-проверка подписи"\,, сек.}
\label{experiment_ecdsa}
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{3}{*}{Кривая} & \multicolumn{3}{c|}{Представление точек} \\
\cline{2-4}
& Стандартное & Стандартные проективные & Координаты Якоби \\
& представление & координаты & \\
\hline
secp224r1 & 23.732 & 11.5254 & 15.1817 \\
\hline
ГОСТ Р 34.10-2012 & 30.6928 & 15.9178 & 19.1709 \\
\hline
secp256r1 & 31.2966 & 15.9515 & 22.1607 \\
\hline
secp384r1 & 78.1508 & 26.1115 & 33.3643 \\
\hline
\end{tabular}
\end{small} 
\end{table}
%\begin{tabular}{|c|c|c|p{1.5cm}|c|c|}\hline
%Марка изделия&Класс бетона&Объём бетона&Класс\par арматуры&Расход арматуры&Масса конструкции\\\hline
%ПГ60.30--2--Т&В\,10&1,43&А--III&24,5&3,43\,т\\
%\end{tabular}

блаблабла больше блабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла
блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла

блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла блаблабла
%\hfil \hbox to 0.3\textwidth{\hrulefill} \smallskip

%Литература
\begin{thebibliography}{99}

\bibitem{s1} \textit{Hankerson D., Menezes A., Vanstone S.} - Guide to Elliptic Curve Cryptography. ~--- New York: Springer-Verlag, 2004 ~--- 311 P.

\bibitem{s2} \textit{Коблиц Н.} Курс теории чисел и криптографии.~--- М.: Научное издательство ТВП, 2001.~--- 254 С.

\bibitem{s3} \textit{Владимиров С.М. [и др.]} - Криптографические методы защиты информации.~--- М.: МФТИ, 2016.~--- 266 С.
%\bibitem{s3}  \textit{Лайонс Р.}  Цифровая обработка сигналов.~--- М.: Бином, 2006.~--- С.~361--369.

\end{thebibliography}

